{% extends "administrar/base.html" %}
{% load static %}

{% block content %}

<div class="container-fluid px-4 mt-4">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="text-primary fw-bold mb-0">
                <i class="bi bi-file-earmark-bar-graph"></i> Reportes Contables
            </h2>
            <p class="text-muted mb-0">Informes y exportaciones del sistema contable</p>
        </div>
    </div>

    <!-- TARJETAS DE REPORTES -->
    <div class="row g-4">

        <!-- Balance de Sumas y Saldos -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-warning bg-opacity-10 text-warning me-3">
                            <i class="bi bi-calculator fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Balance de Sumas y Saldos</h5>
                            <small class="text-muted">Resumen de cuentas</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Genera un balance con los totales de debe, haber y saldos de todas las cuentas contables.
                    </p>
                    <a href="{% url 'balance' %}" class="btn btn-outline-warning btn-sm w-100">
                        <i class="bi bi-file-earmark-spreadsheet"></i> Generar Reporte
                    </a>
                </div>
            </div>
        </div>

        <!-- Libro Mayor -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-info bg-opacity-10 text-info me-3">
                            <i class="bi bi-book fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Libro Mayor</h5>
                            <small class="text-muted">Movimientos por cuenta</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Consulta el detalle de movimientos de una cuenta específica con saldos acumulados.
                    </p>
                    <a href="{% url 'mayor' %}" class="btn btn-outline-info btn-sm w-100">
                        <i class="bi bi-file-earmark-text"></i> Generar Reporte
                    </a>
                </div>
            </div>
        </div>

        <!-- Libro Diario -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-success bg-opacity-10 text-success me-3">
                            <i class="bi bi-journal-text fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Libro Diario</h5>
                            <small class="text-muted">Asientos cronológicos</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Lista todos los asientos contables en orden cronológico con sus movimientos.
                    </p>
                    <button class="btn btn-outline-success btn-sm w-100" onclick="generarLibroDiario()">
                        <i class="bi bi-file-earmark-pdf"></i> Generar Reporte
                    </button>
                </div>
            </div>
        </div>

        <!-- Estado de Resultados -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-primary bg-opacity-10 text-primary me-3">
                            <i class="bi bi-graph-up fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Estado de Resultados</h5>
                            <small class="text-muted">Ganancias y pérdidas</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Muestra los ingresos, gastos y resultado del ejercicio contable.
                    </p>
                    <button class="btn btn-outline-primary btn-sm w-100" onclick="generarEstadoResultados()">
                        <i class="bi bi-file-earmark-bar-graph"></i> Generar Reporte
                    </button>
                </div>
            </div>
        </div>

        <!-- Balance General -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-danger bg-opacity-10 text-danger me-3">
                            <i class="bi bi-pie-chart fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Balance General</h5>
                            <small class="text-muted">Situación patrimonial</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Estado de situación patrimonial con activos, pasivos y patrimonio neto.
                    </p>
                    <button class="btn btn-outline-danger btn-sm w-100" onclick="generarBalanceGeneral()">
                        <i class="bi bi-file-earmark-ruled"></i> Generar Reporte
                    </button>
                </div>
            </div>
        </div>

        <!-- Resumen por Ejercicio -->
        <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm h-100 hover-card">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="icon-box bg-secondary bg-opacity-10 text-secondary me-3">
                            <i class="bi bi-calendar-range fs-3"></i>
                        </div>
                        <div>
                            <h5 class="card-title mb-0">Resumen por Ejercicio</h5>
                            <small class="text-muted">Análisis del período</small>
                        </div>
                    </div>
                    <p class="card-text text-muted small">
                        Resumen completo de un ejercicio contable con todos sus movimientos.
                    </p>
                    <button class="btn btn-outline-secondary btn-sm w-100" onclick="generarResumenEjercicio()">
                        <i class="bi bi-file-earmark-zip"></i> Generar Reporte
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- SECCIÓN DE CONFIGURACIÓN -->
    <div class="card border-0 shadow-sm mt-4">
        <div class="card-header bg-white">
            <h5 class="mb-0">
                <i class="bi bi-gear"></i> Configuración de Reportes
            </h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <label class="form-label fw-bold">Ejercicio Contable</label>
                    <select class="form-select" id="reporteEjercicio">
                        <option value="">Seleccione un ejercicio...</option>
                        <!-- Se llena dinámicamente -->
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Fecha Desde</label>
                    <input type="date" class="form-control" id="reporteFechaDesde">
                </div>
                <div class="col-md-3">
                    <label class="form-label fw-bold">Fecha Hasta</label>
                    <input type="date" class="form-control" id="reporteFechaHasta">
                </div>
                <div class="col-md-2">
                    <label class="form-label fw-bold">Formato</label>
                    <select class="form-select" id="reporteFormato">
                        <option value="excel">Excel (.xlsx)</option>
                        <option value="pdf">PDF</option>
                        <option value="csv">CSV</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- INFORMACIÓN -->
    <div class="alert alert-info mt-4" role="alert">
        <i class="bi bi-info-circle"></i>
        <strong>Nota:</strong> Los reportes se generan en base a los datos del ejercicio y período seleccionado.
        Asegúrese de seleccionar el ejercicio correcto antes de generar un reporte.
    </div>

</div>

<!-- MODAL DE PROGRESO -->
<div class="modal fade" id="modalProgreso" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                    <span class="visually-hidden">Generando...</span>
                </div>
                <h5 id="mensajeProgreso">Generando reporte...</h5>
                <p class="text-muted mb-0">Por favor espere</p>
            </div>
        </div>
    </div>
</div>

<style>
    .hover-card {
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
    }

    .hover-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15) !important;
    }

    .icon-box {
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 10px;
    }
</style>

{% endblock %}

{% block scripts %}
<script src="{% static 'js/administrar/reportes_contables.js' %}?v={% now 'U' %}_2"></script>
{% endblock %}