import{u as E,a as A,b as I,r as t,j as e,h as g,S as k,B as T,E as F,c as q,T as D}from"./main-C-Pq54Gc.js";const i="table_prefs_ctacte_prov_items",z=()=>{const j=E();A(),I();const[m,f]=t.useState([]),[v,u]=t.useState(!0),[d,n]=t.useState(1),[N,y]=t.useState(1),[S,w]=t.useState(0),[c,x]=t.useState(()=>{const s=localStorage.getItem(i),a=parseInt(s,10);return a&&a>0?a:10});t.useEffect(()=>{localStorage.getItem(i)||fetch("/api/config/obtener/").then(s=>s.json()).then(s=>{s.items_por_pagina&&x(s.items_por_pagina)}).catch(console.error)},[]);const[o,h]=t.useState({busqueda:"",estado_deuda:"todos"}),C=s=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(s),p=t.useCallback(async s=>{if(c!==0){u(!0);try{const a=new URLSearchParams({page:d,per_page:c,busqueda:o.busqueda,...o}),r=await(await fetch(`/api/ctacte/proveedores/listar/?${a}`,{signal:s})).json(),_=r.proveedores||r.data||[];f(_),y(r.total_pages||1),w(r.total||0)}catch(a){a.name!=="AbortError"&&console.error("Error al cargar proveedores:",a)}finally{u(!1)}}},[d,o,c]);t.useEffect(()=>{const s=new AbortController;return p(s.signal),()=>s.abort()},[p]);const b=s=>{const{name:a,value:l}=s.target;h(r=>({...r,[a]:l})),n(1)},P=s=>{j(`/ctas-corrientes/proveedores/${s.id}`)};return e.jsxs("div",{className:"container-fluid px-4 pt-4 pb-0 bg-light fade-in main-content-container",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-4",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-primary fw-bold mb-0",style:{fontSize:"2rem"},children:[e.jsx(g,{className:"me-2 inline-block",size:32}),"Cta. Cte. Proveedores"]}),e.jsx("p",{className:"text-muted mb-0 ps-1",style:{fontSize:"1rem"},children:"Gestión de saldos y deuda con proveedores."})]})}),e.jsx("div",{className:"card border-0 shadow-sm mb-4",children:e.jsx("div",{className:"card-body bg-light rounded",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-white border-end-0",children:e.jsx(k,{size:18,className:"text-muted"})}),e.jsx("input",{type:"text",className:"form-control border-start-0",placeholder:"Buscar proveedor por nombre, CUIT...",name:"busqueda",value:o.busqueda,onChange:b})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("select",{className:"form-select",name:"estado_deuda",value:o.estado_deuda,onChange:b,children:[e.jsx("option",{value:"todos",children:"Todos los Estados"}),e.jsx("option",{value:"con_deuda",children:"Con Deuda (Saldo Mayor a $0)"}),e.jsx("option",{value:"al_dia",children:"Al Día (Saldo $0)"}),e.jsx("option",{value:"saldo_favor",children:"A Favor (Saldo Menor a $0)"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsx(T,{onClick:()=>{h({busqueda:"",estado_deuda:"todos"}),n(1)},className:"w-100"})})]})})}),e.jsx("div",{className:"card border-0 shadow mb-4 flex-grow-1 overflow-hidden d-flex flex-column",children:e.jsxs("div",{className:"card-body p-0 d-flex flex-column overflow-hidden",children:[e.jsx("div",{className:"table-responsive flex-grow-1 table-container-fixed",children:e.jsxs("table",{className:"table align-middle mb-0",children:[e.jsx("thead",{className:"table-dark",style:{backgroundColor:"#212529",color:"#fff"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-4 py-3 fw-bold",children:"Proveedor"}),e.jsx("th",{className:"py-3 fw-bold",children:"Documento"}),e.jsx("th",{className:"py-3 fw-bold",children:"Contacto"}),e.jsx("th",{className:"text-end py-3 fw-bold",style:{minWidth:"150px"},children:"Saldo Actual"}),e.jsx("th",{className:"text-center py-3 fw-bold",children:"Estado"}),e.jsx("th",{className:"text-end pe-4 py-3 fw-bold",children:"Acciones"})]})}),e.jsx("tbody",{children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status"})})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"py-5",children:e.jsx(F,{icon:g,title:"No hay proveedores",description:"No se encontraron proveedores en cuenta corriente.",iconColor:"text-blue-500",bgIconColor:"bg-blue-50"})})}):m.map(s=>{const a=parseFloat(s.saldo_actual||0),l=a>0,r=a<0;return e.jsxs("tr",{className:"border-bottom-0 hover-bg-light",children:[e.jsxs("td",{className:"ps-4 py-3",children:[e.jsx("div",{className:"fw-medium text-dark",children:s.nombre}),e.jsx("div",{className:"small text-muted",children:s.direccion||"Sin dirección"})]}),e.jsx("td",{className:"py-3 font-monospace text-secondary",children:s.cuit||"-"}),e.jsx("td",{className:"py-3 text-muted small",children:s.telefono||s.email||"-"}),e.jsx("td",{className:`text-end py-3 fw-bold ${l?"text-danger":r?"text-success":"text-secondary"}`,style:{fontSize:"1.1rem"},children:C(a)}),e.jsx("td",{className:"text-center py-3",children:l?e.jsx("span",{className:"badge bg-danger-subtle text-danger border border-danger px-3 py-2 rounded-pill",children:"Deuda Pendiente"}):r?e.jsx("span",{className:"badge bg-success-subtle text-success border border-success px-3 py-2 rounded-pill",children:"Saldo a Favor"}):e.jsx("span",{className:"badge bg-success-subtle text-success border border-success px-3 py-2 rounded-pill",children:"Al Día"})}),e.jsx("td",{className:"text-end pe-4 py-3",children:e.jsx(q,{onClick:()=>P(s)})})]},s.id)})})]})}),e.jsx(D,{currentPage:d,totalPages:N,totalItems:S,itemsPerPage:c,onPageChange:n,onItemsPerPageChange:s=>{x(s),n(1),localStorage.setItem(i,s)}})]})})]})};export{z as default};
