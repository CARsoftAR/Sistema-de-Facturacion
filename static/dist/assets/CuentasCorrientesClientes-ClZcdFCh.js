import{c as C,u as _,a as A,r as t,j as e,C as E,S as P,B as I,E as k,U as z,T,b as D,d as F,e as q,f as $,s as B}from"./main-CtwLmhxD.js";const R=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],U=C("eye",R),H=()=>{_(),A();const[m,g]=t.useState([]),[f,x]=t.useState(!0),[d,o]=t.useState(1),[N,y]=t.useState(1),[h,v]=t.useState(0),[c,u]=t.useState(()=>{const s=localStorage.getItem(i),a=parseInt(s,10);return a&&a>0?a:10}),[V,G]=t.useState({total_deuda:0,cantidad_deudores:0}),i="table_prefs_ctacte_items";t.useEffect(()=>{localStorage.getItem(i)||fetch("/api/config/obtener/").then(s=>s.json()).then(s=>{s.items_por_pagina&&u(s.items_por_pagina)}).catch(console.error)},[]);const[r,p]=t.useState({busqueda:"",estado_deuda:"todos"}),w=s=>new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(s),b=t.useCallback(async s=>{if(c!==0){x(!0);try{const a=new URLSearchParams({page:d,per_page:c,busqueda:r.busqueda,type:"ctacte",...r}),l=await(await fetch(`/api/clientes/buscar/?${a}`,{signal:s})).json();g(l.clientes||[]),y(l.total_pages||1),v(l.total||0)}catch(a){a.name!=="AbortError"&&console.error("Error al cargar clientes:",a)}finally{x(!1)}}},[d,r,c]);t.useEffect(()=>{const s=new AbortController;return b(s.signal),()=>s.abort()},[b]);const j=s=>{const{name:a,value:n}=s.target;p(l=>({...l,[a]:n})),o(1)},S=s=>{console.log("Ver historial de:",s),B("Próximamente",`Ver historial de ${s.nombre}`,"Entendido",{})};return e.jsxs("div",{className:"container-fluid px-4 pt-4 pb-0 bg-light fade-in main-content-container",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center mb-4",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-primary fw-bold mb-0",style:{fontSize:"2rem"},children:[e.jsx(E,{className:"me-2 inline-block",size:32}),"Cuentas Corrientes"]}),e.jsx("p",{className:"text-muted mb-0 ps-1",style:{fontSize:"1rem"},children:"Gestión de saldos y movimientos de clientes."})]})}),e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card border-0 shadow-sm border-start border-4 border-primary",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"text-muted text-uppercase mb-2",style:{fontSize:"0.8rem",letterSpacing:"1px"},children:"Clientes Visualizados"}),e.jsx("h3",{className:"fw-bold text-dark mb-0",children:h})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card border-0 shadow-sm border-start border-4 border-danger",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"text-muted text-uppercase mb-2",style:{fontSize:"0.8rem",letterSpacing:"1px"},children:"Estado General"}),e.jsx("h3",{className:"fw-bold text-dark mb-0 d-flex align-items-center",children:e.jsx(L,{})})]})})})]}),e.jsx("div",{className:"card border-0 shadow-sm mb-4",children:e.jsx("div",{className:"card-body bg-light rounded",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-white border-end-0",children:e.jsx(P,{size:18,className:"text-muted"})}),e.jsx("input",{type:"text",className:"form-control border-start-0",placeholder:"Buscar cliente por nombre, CUIT...",name:"busqueda",value:r.busqueda,onChange:j})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("select",{className:"form-select",name:"estado_deuda",value:r.estado_deuda,onChange:j,children:[e.jsx("option",{value:"todos",children:"Todos los Estados"}),e.jsx("option",{value:"con_deuda",children:"Con Deuda (Saldo Mayor a $0)"}),e.jsx("option",{value:"al_dia",children:"Al Día (Saldo $0)"}),e.jsx("option",{value:"saldo_favor",children:"A Favor (Saldo Menor a $0)"})]})}),e.jsx("div",{className:"col-md-3",children:e.jsx(I,{onClick:()=>{p({busqueda:"",estado_deuda:"todos"}),o(1)},className:"w-100"})})]})})}),e.jsx("div",{className:"card border-0 shadow mb-4 flex-grow-1 overflow-hidden d-flex flex-column",children:e.jsxs("div",{className:"card-body p-0 d-flex flex-column overflow-hidden",children:[e.jsx("div",{className:"table-responsive flex-grow-1 table-container-fixed",children:e.jsxs("table",{className:"table align-middle mb-0",children:[e.jsx("thead",{className:"table-dark",style:{backgroundColor:"#212529",color:"#fff"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-4 py-3 fw-bold",children:"Cliente"}),e.jsx("th",{className:"py-3 fw-bold",children:"Documento"}),e.jsx("th",{className:"py-3 fw-bold",children:"Contacto"}),e.jsx("th",{className:"text-end py-3 fw-bold",style:{minWidth:"150px"},children:"Saldo Actual"}),e.jsx("th",{className:"text-center py-3 fw-bold",children:"Estado"}),e.jsx("th",{className:"text-end pe-4 py-3 fw-bold",children:"Acciones"})]})}),e.jsx("tbody",{children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status"})})}):m.length===0?e.jsx("td",{colSpan:"6",className:"py-5",children:e.jsx(k,{icon:z,title:"No hay clientes",description:"No se encontraron clientes en cuenta corriente.",iconColor:"text-blue-500",bgIconColor:"bg-blue-50"})}):m.map(s=>{const a=parseFloat(s.saldo_actual||0),n=a>0,l=a<0;return e.jsxs("tr",{className:"border-bottom-0 hover-bg-light",children:[e.jsxs("td",{className:"ps-4 py-3",children:[e.jsxs("div",{className:"fw-bold text-dark",children:[s.nombre," ",s.apellido]}),e.jsx("div",{className:"small text-muted fw-medium",children:s.direccion||"Sin dirección"})]}),e.jsx("td",{className:"py-3 font-monospace text-secondary fw-medium",children:s.dni||s.cuit||"-"}),e.jsx("td",{className:"py-3 text-muted small fw-medium",children:s.telefono||"-"}),e.jsx("td",{className:`text-end py-3 fw-bold ${n?"text-danger":l?"text-success":"text-secondary"}`,style:{fontSize:"1.1rem"},children:w(a)}),e.jsx("td",{className:"text-center py-3",children:n?e.jsxs("span",{className:"badge bg-danger-subtle text-danger border border-danger px-3 py-2 rounded-pill",children:[e.jsx(T,{size:14,className:"me-1 mb-1"})," Deudor"]}):l?e.jsxs("span",{className:"badge bg-success-subtle text-success border border-success px-3 py-2 rounded-pill",children:[e.jsx(D,{size:14,className:"me-1 mb-1"})," A Favor"]}):e.jsxs("span",{className:"badge bg-light text-secondary border px-3 py-2 rounded-pill",children:[e.jsx(F,{size:14,className:"me-1 mb-1"})," Al Día"]})}),e.jsx("td",{className:"text-end pe-4 py-3",children:e.jsx(q,{icon:U,onClick:()=>S(s),className:"btn-outline-primary btn-sm",tooltip:"Ver Historial"})})]},s.id)})})]})}),e.jsx($,{currentPage:d,totalPages:N,totalItems:h,itemsPerPage:c,onPageChange:o,onItemsPerPageChange:s=>{u(s),o(1),localStorage.setItem(i,s)}})]})})]})},L=()=>e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsxs("span",{className:"position-relative d-flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-success opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-success"})]}),e.jsx("span",{className:"text-muted small fw-normal",children:"Sistema Activo"})]});export{H as default};
